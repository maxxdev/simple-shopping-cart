class SimpleShoppingCart{constructor(t){this.id=t||"simpleShoppingCart",this.items=[],this.promocodes=[],this.init()}init(){this.load(),this._updateCart()}get cart(){return{items:this.items,promocodes:this.promocodes}}set cart(t){t&&(this.items=t.items||[],this.promocodes=t.promocodes||[])}save(){localStorage.setItem(this.id,JSON.stringify(this.cart))}load(){this.cart=JSON.parse(localStorage.getItem(this.id))}clear(){this.items=[],this.promocodes=[],this.save()}getItems(){return this.items||[]}addPromocode(t){this.promocodes.push(t),this._updateCart()}isItemInCart(t){return!!this.getById(t.id)}getById(t){return this.getItems().find(e=>e.id===t)}getIndexById(t){return this.getItems().findIndex(e=>e.id===t)}removeItem(t){const e=this.getItems();let i=this.getIndexById(t.id);return i>-1&&(e.splice(i,1),this._updateCart(),!0)}addItem(t){return this.putItem(t,1)}putItem(t,e=1){if(!t.hasOwnProperty("id")||!t.hasOwnProperty("price"))throw new Error('Item doesn\'t have "id" or "price" attribute');t.price=parseFloat(t.price),t.qty=parseInt(t.qty);let i=this.getById(t.id);return i?(i.price=t.price,i.qty+=e):this.items.push(t),this._updateCart(),{...t}}_updateCart(){const t=this.getItems();if(!t)return void this.clear();const e=this.promocodes||[];t.forEach(t=>{t.priceWithDiscount=t.price,e.length>0&&e.forEach(e=>{t.priceWithDiscount=e.rate*t.price/100});t.getCost=function(t=!0){return t?this.priceWithDiscount:this.price},t.getSum=function(t=!0){return this.qty*(t?this.priceWithDiscount:this.price)}}),this.save()}get totalCost(){return this.items.reduce((t,e)=>t+e.qty*e.price,0)}get totalQty(){return this.items.reduce((t,e)=>t+e.qty,0)}}